import subprocess

def get_wifi_profiles():
    profiles_data = subprocess.check_output(['netsh', 'wlan', 'show', 'profiles']).decode('utf-8', errors='ignore').split('\n')
    profiles = [line.split(":")[1].strip() for line in profiles_data if "All User Profile" in line]
    return profiles

def get_wifi_password(profile):
    profile_info = subprocess.check_output(['netsh', 'wlan', 'show', 'profile', profile, 'key=clear']).decode('utf-8', errors='ignore').split('\n')
    password_line = [line for line in profile_info if "Key Content" in line]
    if password_line:
        return password_line[0].split(":")[1].strip()
    else:
        return None

def main():
    profiles = get_wifi_profiles()
    credentials = ''
    for profile in profiles:
        try:
            password = get_wifi_password(profile)
            credentials += str(profile) + ' : ' + str(password) + "\n"
        except subprocess.CalledProcessError as e:
            pass
    print(credentials)

if __name__ == "__main__":
    main()
